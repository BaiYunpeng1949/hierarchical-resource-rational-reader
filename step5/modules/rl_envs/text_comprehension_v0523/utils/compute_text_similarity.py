from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.metrics.pairwise import cosine_similarity

from sentence_transformers import SentenceTransformer, util

from bert_score import score

def compute_cosine_similarity(text1, text2):
    texts = [text1, text2]
    tfidf = TfidfVectorizer().fit_transform(texts)
    similarity_score = cosine_similarity(tfidf[0:1], tfidf[1:2])
    return similarity_score[0][0]

def compute_semantic_similarity(text1, text2):
    model = SentenceTransformer('all-MiniLM-L6-v2')
    emb1 = model.encode(text1, convert_to_tensor=True)
    emb2 = model.encode(text2, convert_to_tensor=True)
    similarity = util.cos_sim(emb1, emb2)
    return similarity.item()


if __name__ == "__main__":
    original_high_coherence_text = "The heart is the hardest working organ in the body. We rely on it to supply blood regularly to the body every moment of every day. Any disorder that stops the heart from supplying blood to the body is a threat to life. Heart disease is such a disorder. It is very common. More people are killed every year in the U.S. by heart disease than by any other disease. There are many kinds of heart disease, some of which are present at birth and some of which are acquired later. 1. Congenital Heart Disease A congenital heart disease is a defect that a baby is born with. Most babies are born with perfect hearts. But one in every 200 babies is born with a bad heart. For example, hearts have flaps, called valves, that control the blood flow between its chambers. Sometimes a valve develops the wrong shape. It may be too tight, or fail to close properly, resulting in congenital heart disease. Sometimes a gap is left in the wall, or septum, between the two sides of the heart. This congenital heart disease is often called a 'septal defect.' When a baby's heart is badly shaped, it cannot work efficiently. It cannot pump enough blood through the lungs so that it receives enough oxygen. As a result, the baby becomes breathless. The blood also cannot get rid of carbon dioxide through the lungs. Therefore, the blood becomes purplish, which causes the baby's skin to look blue. Fortunately, it is now possible to save the lives of many 'blue babies.' 2. Acquired Heart Disease Some heart diseases are acquired after the baby is born. Rheumatic fever is an example of an acquired disease that may cause damage to the heart. This disease usually follows a sore throat caused by bacteria known as streptococci. This is often called 'strep throat.' When strep throat causes rheumatic fever, the tissues of the heart become inflamed. If the heart is badly affected, it fails very soon. Usually, however, it recovers, and the results of the damage are seen only years later. This is because the rheumatic fever leaves scars in the valves of the heart. Therefore, they cannot work properly. This puts a strain on the heart so that eventually it may fail. The effects of the rheumatic fever may take up to twenty or thirty years to appear. Coronary disease is another example of an acquired heart disease. This disease affects the coronary arteries. These are the blood vessels that extend across the heart and supply it with blood from the lungs. They are very important because they give the heart muscle the oxygen it needs to carry on working. In coronary disease the coronary arteries become blocked, causing parts of the heart muscle to die because of the lack of oxygen. When this happens, the patient has a heart attack, which can be fatal. The blockage of a coronary artery is usually caused by a clot of blood, called a 'thrombus.' When a clot forms in a coronary artery, this is called 'coronary thrombosis.' That is the correct name for a heart attack. In normal arteries, blood does not form clots. But in coronary disease, the walls of the arteries are not normal. They become lumpy, rough, and narrow. The lumps break off and form clots that stop the flow of blood to the heart. Other examples of acquired heart disease are arrhythmia, angina, and high blood pressure. Arrhythmia, which means 'lack of rhythm,' is an interruption of the heart's normal beat. Angina is a sharp pain in the chest which is very similar to that caused by a heart attack, or thrombosis. High blood pressure is one of the most common heart diseases. It places a heavy strain on the heart and other organs. Therefore, if it is not treated, high blood pressure may lead to heart attacks, kidney failure, or other serious problems. High blood pressure is a disease which has no symptoms. Thus, a person may not be aware of having it unless the blood pressure is measured. 3. Treatment and Prevention of Heart Disease Since the mid-1960's, medical science has made tremendous progress in the treatment and prevention of heart disease. Both new drugs and new surgical methods have been developed. Among the new drugs for treating heart disease are chemicals called 'beta blockers.' The beta-blockers lessen the after-effects of heart attacks; they can prevent second attacks; and they can lower the blood pressure of people who have high blood pressure. Other drugs dissolve the lumps which break off the walls of arteries so that they do not stop the flow of blood to the heart. Surgical techniques for treating heart disease range from repairing or replacing damaged parts, such as valves or arteries, to replacement of the entire heart. If a heart has been so damaged that it can no longer function, it can be replaced by a mechanical heart, or, more often, by a heart transplant. In transplant surgery, the healthy heart of someone who has died replaces the diseased heart of the patient. Mechanical devices can be implanted in people's bodies to keep their hearts functioning. The pacemaker is the most common of these devices. It does not heal the diseased heart, but it relieves the symptoms of an irregular heart beat and maintains the steady beat needed for normal living. When a heart cannot pump enough blood through the lungs because of poorly functioning valves, the valves can be replaced with artificial ones of plastic and metal. For patients with coronary disease, 'by-pass surgery' is often used to repair clogged or damaged arteries. Doctors use pieces of a patient's own veins, often from the leg, to replace the damaged portions of arteries. Preventive care is also getting better as scientists learn more and more about the causes of heart disease. They have shown that diet can be an important means of controlling heart disease. For example, a substance called cholesterol is known to cause a build-up of fatty substances in the blood vessels, which can cause blood clots to form in the arteries. Therefore, doctors stress the importance of a diet low in cholesterol. Similarly, salt is known to increase blood pressure, so doctors recommend a low-salt diet for patients with high blood pressure"
    recalled_high_coherence_text_high_knowledge = "The heart is a hardworking organ in the body. We rely on the heart to supply blood regularly, and we rely on it every moment. Any disorder stopping the heart is a threat to life. Heart disease is such a disorder. Heart disease is common, and it kills more people in the U.S. than any other disease. There are many kinds of heart disease. Some are present at birth, and some are acquired later. Congenital heart disease is a defect. A baby may be born with congenital heart disease, but most babies are born with perfect hearts. One in 200 babies is born with a bad heart. Hearts have valves, which are called flaps. These valves control blood flow between heart chambers. Sometimes, a valve develops in the wrong shape. It may be too tight or fail to close. Such a valve defect results in congenital heart disease. A gap may be left in the septal wall between the sides of the heart. This congenital heart disease is called a septal defect. A baby's heart may be badly shaped and cannot work efficiently. It cannot pump enough blood to the lungs or receive enough oxygen. As a result, the baby becomes breathless. If the blood cannot expel CO₂ in the lungs, it becomes purplish, which causes the skin to look blue. It is possible to save the lives of such blue babies. Heart disease acquired after birth includes rheumatic fever. Rheumatic fever is an acquired disease that causes damage to the heart. It follows a sore throat caused by streptococci, also called strep throat. Strep throat causes rheumatic fever. Heart tissues become inflamed. If the heart is badly affected, it may fail soon. The heart can recover, but damage results may be seen years later. Rheumatic fever leaves scars in the valves, and the valves cannot work properly. This puts strain on the heart, which may fail. The effects of the fever may take twenty to thirty years. Coronary disease is another acquired heart disease. It affects the coronary arteries, which extend across the heart. These arteries supply blood from the lungs and give oxygen to the heart muscle. The heart muscle needs oxygen to carry on working. If the coronary arteries become blocked, the blockage causes muscle tissue death due to a lack of oxygen. As a result, the patient has a heart attack, which can be fatal. The blockage may be caused by a blood clot called a thrombus. A clot in a coronary artery is called coronary thrombosis, which is the correct name for a heart attack. Normally, blood does not form clots in normal arteries. But in abnormal coronary arteries, the artery walls become lumpy, rough, and narrow. Lumps may break off and form clots, which stop the flow of blood to the heart. Other acquired heart diseases are arrhythmia, angina, and high blood pressure. Arrhythmia is an interruption of the heartbeat and means a lack of rhythm. Angina is a sharp pain in the chest, similar to the pain from a heart attack. High blood pressure is common. It places strain on the heart and other organs. If not treated, high blood pressure may lead to heart attacks, kidney failure, and other serious problems. High blood pressure may have no symptoms. A person may not be aware of having it unless blood pressure is measured. Medical science has made progress in the treatment and prevention of heart disease since the mid-1960s. New drugs and new surgical methods have been developed. Beta blockers are among the new drugs. These chemicals lessen the after-effects of heart attacks, prevent second attacks, and lower blood pressure. Other drugs dissolve lumps that break off from artery walls and prevent them from stopping blood flow. Surgical techniques range from repair to replacement. Damaged parts such as valves or arteries may be repaired or replaced. If a heart is so damaged that it cannot function, it can be replaced by a mechanical heart or more often by a heart transplant. In a transplant, the healthy heart of a deceased person replaces the heart of the patient. Mechanical devices can be implanted in human bodies to keep hearts functioning. The most common device is the pacemaker. A pacemaker does not heal the diseased heart but relieves symptoms of an irregular beat and maintains a steady beat. A steady beat is needed for normal living. A damaged heart that cannot pump enough blood to the lungs may have its valves replaced with artificial ones made of plastic and metal. For coronary disease, bypass surgery is used to repair damaged arteries. Doctors use the patient's own veins from the leg to replace the damaged portions of arteries. Preventive care is improving. Scientists are learning more about the causes of heart disease. Diet has been shown to be important in control. Cholesterol causes the build-up of fatty substances in blood vessels. This build-up can cause blood clots. Therefore, doctors stress a low-cholesterol diet. Salt increases blood pressure, so doctors recommend a low-salt diet."
    recalled_high_coherence_text_low_knowledge = "The heart is the hardest-working organ in the body. We rely on the heart to supply blood every moment. If the heart stops supplying blood, it causes a life-threatening situation. Heart disease is a disorder and is very common. It kills more people than any other disease. There are many kinds of heart disease. Some are present at birth, and some are acquired later. Congenital heart disease is a defect present at birth. Most babies are born with perfect hearts, but one in 200 babies is born with a bad heart. The heart has valves that control blood flow between its chambers. Sometimes a valve develops the wrong shape, which can cause congenital heart disease. A valve may be too tight or may fail to close. A gap may be left in the septum. This is called a septal defect. When a baby's heart is badly shaped, it cannot work efficiently. It may not pump enough blood or receive enough oxygen. As a result, the baby becomes breathless. The blood cannot expel carbon dioxide and becomes purplish, causing the skin to look blue. It is possible to save the lives of these \"blue babies.\" Heart disease can also be acquired after birth. Rheumatic fever is an example. It follows strep throat, which is caused by streptococci. Rheumatic fever can inflame heart tissues. If the heart is badly affected, it may fail soon, though it usually recovers. Damage from rheumatic fever may become visible years later. It can leave scars on heart valves, which then cannot work properly. These scars cause strain on the heart, which may eventually fail. These effects may appear 20 to 30 years later. Coronary disease is another example of acquired heart disease. It affects the coronary arteries, which supply blood and oxygen to the heart muscle. If the arteries are blocked, the heart muscle may die, causing a heart attack, which can be fatal. A blood clot can block the artery. This clot is called a thrombus. A clot in a coronary artery is called coronary thrombosis, which is a form of heart attack. Normally, arteries do not form clots. In disease, arteries are not normal; their walls become lumpy and narrow. Lumps can break off and form clots, which stop blood flow. Other acquired heart diseases include arrhythmia, angina, and high blood pressure. Arrhythmia is an interrupted heartbeat. Angina is chest pain that resembles a heart attack. High blood pressure is a common heart disease. It causes strain on the heart and other organs. If untreated, it can lead to serious problems. High blood pressure usually has no symptoms and is only known if measured. Since the 1960s, treatment has progressed. New drugs and new surgeries have been developed. Beta blockers are a new drug. They lessen after-effects, prevent second attacks, and lower high blood pressure. Some drugs dissolve artery lumps and prevent blood blockages. Surgical techniques include repairing or replacing parts or even transplanting the entire heart. A damaged heart can be replaced by a mechanical heart or a donor heart. Devices can be implanted to maintain heart function. The pacemaker is a common device that relieves symptoms and maintains a steady beat. Damaged valves can be replaced with artificial ones. Bypass surgery uses the patient's veins to replace blocked arteries. Prevention has improved due to better knowledge. Diet affects heart disease. Cholesterol causes fatty buildup, which can lead to clots. Doctors recommend a low-cholesterol diet. Salt can cause high blood pressure, so doctors recommend a low-salt diet."

    original_low_coherence_text = "The heart is the hardest-working organ in the body. We rely on a regular blood supply every moment of every day. Any disorder that stops the blood supply is a threat to life. Heart disease is very common. More people are killed every year in the U.S. by heart disease than by any other disease. A congenital disease is one that a person is born with. Most babies are born with perfect hearts. In about one in every 200 cases something goes wrong. Sometimes a valve develops the wrong shape. It may be too tight, or fail to close properly. Sometimes a gap is left in the septal wall between the two sides of the heart. This is often called a septal defect. When a baby's heart is badly formed, it cannot work efficiently. The blood does not receive enough oxygen. The baby becomes breathless. The blood cannot get rid of carbon dioxide through the lungs. It becomes purplish, and the baby's skin looks blue. It is now possible to save the lives of many blue babies. The disease called rheumatic fever may cause harm to the heart. The disease usually follows a sore throat caused by bacteria called streptococci. The tissues of the heart become inflamed. If it is badly affected, it fails. Usually it recovers, and the results of the damage are seen only years later. The valves of the heart are left with scars. They cannot work properly. This puts a strain on the heart. Eventually it may fail. The effects of the rheumatic fever may take up to twenty or thirty years to appear. The blood vessels that extend across the heart and supply it with blood are called the coronary arteries. They are very important. They give the heart the oxygen it needs to carry on working. If they become blocked, parts of the heart muscle will die. The patient has a heart attack, which can be fatal. The blockage of a coronary artery is usually caused by a thrombus, or blood clot. Coronary thrombosis happens when a clot forms in a coronary artery. That is the correct name for a heart attack. In normal arteries, blood does not form clots. In coronary disease, the walls of the blood vessels become lumpy, rough, and narrow. Arrhythmia is an interruption of the heart's normal beat. Angina is a sharp pain in the chest which is very similar to that caused by thrombosis. High blood pressure is very common. If untreated, high blood pressure may lead to heart attacks, kidney failure, or other serious problems. High blood pressure may have no symptoms. A person may not be aware of having it unless the blood pressure is measured. Among the new drugs for treating heart disease are a family of compounds called beta blocking drugs, or simply, beta blockers. They lessen the after-effects of heart attacks, can prevent second attacks, and can lower the blood pressure of people who have high blood pressure. Other drugs dissolve the lumps which break off the walls of veins and arteries. Heart transplants are used more often than mechanical hearts. In transplant surgery, the healthy heart of someone who has died replaces the heart of the patient. Mechanical devices can be implanted in people's bodies to keep their hearts functioning. The commonly used pacemaker does not heal the diseased heart, but it relieves the symptoms of an irregular heart and keeps a steady beat for normal living. When a heart cannot pump enough blood through the lungs because of poorly functioning valves, the valves can be replaced with artificial ones of plastic and metal. By-pass surgery is used to repair clogged or damaged blood vessels. Doctors use pieces of a patient's own veins, often from the leg, to replace the damaged portions of arteries. A substance called cholesterol is known to cause a build-up of fatty substances in the blood vessels, which can lead to heart disease, so doctors stress the importance of a diet low in fats. Salt is known to increase the blood pressure, so a low-salt diet is recommended."
    recalled_low_coherence_text_high_knowledge = "The heart is a hardworking organ in the body. We rely on the heart for blood supply, and any disorder is a threat to life. Heart disease is common and kills many people. Congenital disease is a type of disease, and a person may be born with congenital disease, though most babies are born with perfect hearts. Sometimes something goes wrong. A valve may develop the wrong shape, becoming too tight or failing to close. A gap may be left in the septal wall, and this is called a septal defect. A baby's heart may be formed badly and cannot work efficiently. The baby's heart may not pump enough blood to the lungs or receive enough oxygen. As a result, the baby becomes breathless. The blood cannot expel carbon dioxide and becomes purplish. The skin then looks blue. It is possible to save the lives of blue babies. Rheumatic fever can cause harm to the heart and often follows a sore throat, which is caused by streptococci. The tissues of the heart become inflamed, and the heart is affected badly. Sometimes the heart may fail, or it may recover. Damage results can be seen years later. The valves may be left with scars and cannot work properly, which puts a strain on the heart, and the heart may fail. The effects of the fever may take twenty to thirty years. The blood vessels supplying the heart are called coronary arteries. These blood vessels extend across the heart and supply blood. Coronary arteries are important because they give oxygen to the heart, which needs oxygen to carry on working. If the coronary arteries become blocked, parts of the heart muscle will die, and the patient has a heart attack. A heart attack can be fatal. It is caused by blockage from a thrombus, which is a blood clot. Coronary thrombosis happens when there is a clot in the artery, and this is the correct name for a heart attack. Normally, blood does not form clots in normal arteries, but in disease, the walls of blood vessels become lumpy, rough, and narrow. Arrhythmia is an interruption of the heartbeat. Angina is a sharp pain and is similar to pain from thrombosis. High blood pressure is common and, if untreated, may lead to heart attacks, kidney failure, and other serious problems. High blood pressure may have no symptoms, and a person may not be aware of it unless blood pressure is measured. There are new drugs called beta blockers. Beta blocking drugs lessen the after-effects of heart attacks, prevent second attacks, and lower blood pressure. Other drugs dissolve lumps that break off from the walls of veins and arteries. Heart transplants are used more often than mechanical hearts. In a transplant, the healthy heart of a deceased person replaces the heart of a patient. Mechanical devices can be implanted in human bodies to keep hearts functioning. A pacemaker does not heal a diseased heart, but it relieves the symptoms of an irregular heart and keeps a steady beat for normal living. When the heart cannot pump enough blood to the lungs, poorly functioning valves may be the cause. Valves can be replaced with artificial ones made of plastic and metal. Bypass surgery is used to repair clogged or damaged vessels. Doctors may use the patient's own veins from the leg to replace damaged portions of arteries. Cholesterol causes a build-up of fatty substances in blood vessels, and this build-up can lead to heart disease. Doctors stress the importance of a low-fat diet. Salt increases blood pressure, so a low-salt diet is recommended."
    recalled_low_coherence_text_low_knowledge = "The heart is a hardworking organ in the body. It is located inside the body and is essential because we rely on a regular blood supply every moment. Any disorder that stops this blood supply is a threat to life. Heart disease is a common condition and kills many people. In the U.S., more people are killed by heart disease than by any other disease. A congenital disease is a type of disease that a person is born with. Most babies are born with perfect hearts, but in about one out of every 200 cases, something goes wrong. Sometimes a valve in the heart develops the wrong shape—it may be too tight or fail to close. Occasionally, a gap remains in the septal wall between the two sides of the heart. This is called a septal defect. If a baby's heart is badly formed, it cannot work efficiently. The blood does not receive enough oxygen, causing the baby to become breathless. The blood may also fail to remove carbon dioxide and turn purplish, making the baby's skin look blue. It is possible to save such \"blue babies.\" Rheumatic fever can cause harm to the heart. It often follows a sore throat caused by streptococci. This condition inflames the heart tissues, and the heart may be badly affected. Sometimes it fails, although it usually recovers. However, the effects of the damage can appear years later. The valves may be left with scars and not work properly, placing strain on the heart and possibly leading to eventual failure. These effects can take years to develop. The heart receives blood through the coronary arteries, which are its own blood vessels. These arteries are important because they supply the heart with oxygen, which it needs. If the coronary arteries are blocked, parts of the heart muscle may die. This can cause a heart attack, which is often fatal. One cause of blockage is a thrombus, a blood clot that forms in a coronary artery. This condition is also called coronary thrombosis. In a normal artery, no clot is present. In coronary disease, the vessel walls become narrow and rough. An arrhythmia is when the heartbeat is interrupted, while angina is chest pain that can feel similar to the pain from thrombosis. High blood pressure is also common. If untreated, it can lead to heart attacks, kidney failure, and other problems. It may show no symptoms but can be detected through measurement. New drugs have been developed to treat heart disease. Beta blockers can lessen the after-effects of a heart attack, prevent a second attack, and lower blood pressure. Other drugs can dissolve the lumps that break off from artery walls. Surgical methods also exist. A heart transplant is now more common than the use of a mechanical heart. In transplant surgery, a diseased heart is replaced with a donor heart. Mechanical devices can also be implanted into the body to help the heart function. The pacemaker is the most common of these devices. While it does not heal the heart, it helps relieve symptoms of irregular heartbeat and maintains a steady beat. In some cases, damaged valves are replaced with artificial valves made of plastic or metal. Bypass surgery repairs blood vessels using veins from the leg to replace damaged arteries. Cholesterol can cause fatty buildup in the arteries, which can lead to heart disease. To prevent this, a diet low in fats is recommended. Increased salt in the diet can raise blood pressure, so a diet low in salt is also advised."

    # print(f"Cosine Similarity for high coherence text and high knowledge: {compute_cosine_similarity(original_high_coherence_text, recalled_high_coherence_text_high_knowledge)}")
    print(f"Semantic Similarity for high coherence text and high knowledge: {compute_semantic_similarity(original_high_coherence_text, recalled_high_coherence_text_high_knowledge)}")

    # print(f"Cosine Similarity for high coherence text and low knowledge: {compute_cosine_similarity(original_high_coherence_text, recalled_high_coherence_text_low_knowledge)}")
    # print(f"Semantic Similarity for high coherence text and low knowledge: {compute_semantic_similarity(original_high_coherence_text, recalled_high_coherence_text_low_knowledge)}")

    # print(f"Cosine Similarity for low coherence text and high knowledge: {compute_cosine_similarity(original_low_coherence_text, recalled_low_coherence_text_high_knowledge)}")
    # print(f"Semantic Similarity for low coherence text and high knowledge: {compute_semantic_similarity(original_low_coherence_text, recalled_low_coherence_text_high_knowledge)}")

    # print(f"Cosine Similarity for low coherence text and low knowledge: {compute_cosine_similarity(original_low_coherence_text, recalled_low_coherence_text_low_knowledge)}")
    # print(f"Semantic Similarity for low coherence text and low knowledge: {compute_semantic_similarity(original_low_coherence_text, recalled_low_coherence_text_low_knowledge)}")